# 基于STM32的简易示波器信号发生器
## 一、基本描述  
>本项目基于HAL库，在STM32H743VIT6上实现使用ADC采集信号，通过DAC输出波形，并且可以通过串口发送指令控制输出的波形、频率以及PWM波的占空比的同时将ADC采集的信号在OLED上显示出来，还可以测量频率最大最小电压值
## 二、注意事项

1. 项目中相关外设的配置信息可能与CubeMAX中的配置不同，在重新生成代码时要注意参数变化
2. 项目中的DAC功能暂时不能修改电压，虽然在其配置结构体（非初始化结构体）中设有该参数
3. 项目中ADC采集采用动态采样率，使用时需将[ADC_IN](#四引脚定义)与[TIM2_CH3_CC](#四引脚定义)短接在一起
4. 受限于STM32，ADC/DAC只能输入输出正电压
5. 项目中输入/输出的频率不宜超过10KHz   
    > * 若输入信号频率超过10KHz，则显示出的波形会十分混乱  
    > * 若输出信号频率超过10KHz，则输出的频率与设置频率由极大差距
6. 本项目PWM的输出是由DAC完成的，但是也设置了使用TIM4CH1输出（此部分已注释）
7. 在屏幕上显示的内容：
    > - 第一行是输入的频率
    > - 中间区域是输入的波形
    > - 最下方一行依次是最大值最小值（电压）
8. 设置DAC的波形输出通过自定义的AT指令完成

## 三、自定义的AT指令
- 指令格式  
    > AT+<设置的波形>+<设置的参数>=<参数>  
     例如：输出一个2000Hz的正弦波  
     ` AT+Sin+Freq=2000 `
- 参数<设置的波形>：
    - Sin ：正弦波  
    - PWM ：PWM波  
    - Trg ：三角波
- 参数<设置的参数>：  
    - Freq ：频率
    - Duty ：正占空比（此参数只在输出波形为PWM时有效，范围 5~95
## 四、引脚定义
| 名称 | Pin | 名称 | Pin |
| :----: | :----: | :----: | :----: |
| ADC_IN | PA7 | DAC_OUT | PA4 |
| TIM2_CH3_CC | PA2 | TIM4_CH1_OC | PD12|
| IIC_SCL | PB10 | IIC_SDA | PB11 |
| USART_Tx | PB14 | USART_Rx | PB15 |
